(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["SmsSendSettings~31ecd969"],{"45fc":function(e,t,a){"use strict";var s=a("23e7"),r=a("b727").some,n=a("a640"),o=a("ae40"),l=n("some"),i=o("some");s({target:"Array",proto:!0,forced:!l||!i},{some:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},"4cc7":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"send"},[a("h5",{staticClass:"mt-0"},[e._v(e._s(e.$lang.send_settings_hint)+" ")]),a("el-row",{attrs:{gutter:15}},[a("el-row",{staticClass:"topform_wrap"},[a("el-form",{ref:"elForm",attrs:{model:e.formData,rules:e.rules,"label-width":"auto"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-col",{attrs:{span:6,xs:24,sm:10,md:24}},[a("el-form-item",{attrs:{label:"",prop:"range_type","label-width":"0px"}},[a("el-tabs",{on:{"tab-click":e.dataInit},model:{value:e.formData.range_type,callback:function(t){e.$set(e.formData,"range_type",t)},expression:"formData.range_type"}},e._l(e.range_typeOptions,(function(e,t){return a("el-tab-pane",{key:t,attrs:{label:e.label,name:e.value}})})),1)],1)],1),a("el-col",{attrs:{span:6,xs:24,sm:10,md:24}},[a("el-form-item",{attrs:{label:e.$lang.sms_switch,"label-width":"74px"}},[a("el-switch",{model:{value:e.formData.zkg,callback:function(t){e.$set(e.formData,"zkg",t)},expression:"formData.zkg"}})],1)],1),e.formData.zkg?[a("el-col",{attrs:{span:6,xs:24,sm:10,md:24}},[a("el-form-item",{attrs:{label:e.$lang.switching_suppliers,prop:"sms_operator","label-width":"80px"}},[e.gysShow?a("el-select",{attrs:{size:"small"},on:{change:e.gysChange},model:{value:e.formData.sms_operator,callback:function(t){e.$set(e.formData,"sms_operator",t)},expression:"formData.sms_operator"}},e._l(e.sms_operatorOptions,(function(e,t){return a("el-option",{key:t,attrs:{value:e.label,label:e.value}})})),1):e._e()],1)],1)]:e._e()],2),e.formData.zkg?e._l(e.pageDataArr,(function(t,s){return a("el-col",{key:t.id,attrs:{span:24}},[a("div",{staticClass:"wrapper__from mb-20",attrs:{"data-title":s}},[a("el-row",{staticClass:" ml-23"},e._l(t,(function(t,s){return a("el-col",{key:"innerItem"+s,attrs:{xs:24,sm:18,md:12,xl:8}},[a("el-form-item",{attrs:{label:t.type,prop:t.name}},[a("el-select",{staticClass:"mr-10",style:{width:"260px"},attrs:{size:"small",placeholder:e.$lang.please_choose+t.type,clearable:""},model:{value:t.name_value,callback:function(a){e.$set(t,"name_value",a)},expression:"innerItem.name_value"}},e._l(e.generated_invoiceOptions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.temp,value:e.id,disabled:e.disabled}})})),1),a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.is_use_value,callback:function(a){e.$set(t,"is_use_value",a)},expression:"innerItem.is_use_value"}})],1)],1)})),1)],1)])})):e._e()],2)],1)],1)],1),a("div",{staticClass:"bottomOperationAdd"},[a("el-button",{attrs:{size:"small",type:"primary",loading:e.btnLoading},on:{click:e.submitForm}},[e._v(e._s(e.$lang.submit))]),a("el-button",{attrs:{size:"small"},on:{click:e.resetForm}},[e._v(e._s(e.$lang.reset))]),a("el-button",{attrs:{size:"small",type:"success"},on:{click:function(t){e.testDialog=!0}}},[e._v(e._s(e.$lang.test_send))])],1),a("el-dialog",{attrs:{title:e.$lang.test_send,visible:e.testDialog,width:"600px"},on:{"update:visible":function(t){e.testDialog=t},open:e.testSendPage,close:function(t){e.testSendFrom.phone=""}}},[a("el-form",{ref:"suspendRef",attrs:{model:e.testSendFrom,"label-width":"auto"}},[a("el-form-item",{attrs:{label:e.$lang.cellphone,prop:"phone"}},[a("el-input",{attrs:{size:"small",placeholder:e.$lang.enter_cellphone},model:{value:e.testSendFrom.phone,callback:function(t){e.$set(e.testSendFrom,"phone",t)},expression:"testSendFrom.phone"}},[a("el-select",{attrs:{slot:"prepend",size:"small",filterable:""},slot:"prepend",model:{value:e.testSendFrom.code,callback:function(t){e.$set(e.testSendFrom,"code",t)},expression:"testSendFrom.code"}},e._l(e.sms_countryOptions,(function(e){return a("el-option",{key:e.id,attrs:{label:e.link,value:e.phone_code}})})),1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.testDialog=!1}}},[e._v(e._s(e.$lang.cancel))]),a("el-button",{attrs:{size:"small",type:"primary",loading:e.submitLoading},on:{click:e.testSend}},[e._v(e._s(e.$lang.confirm))])],1)],1),a("el-dialog",{attrs:{title:e.$lang.hint,visible:e.gysTip,width:"30%"},on:{"update:visible":function(t){e.gysTip=t}}},[a("span",[e._v(e._s(e.$lang.switching_suppliers_hint))]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.gysTip=!1,e.formData.sms_operator=e.oldGysVal}}},[e._v(e._s(e.$lang.cancel))]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataInit("qhSure")}}},[e._v(e._s(e.$lang.confirm))])],1)])],1)},r=[],n=(a("4160"),a("45fc"),a("b0c0"),a("d3b7"),a("25f0"),a("159b"),a("96cf"),a("1da1")),o=a("6770"),l={metaInfo:{title:window.zjmf_cw_lang.send_setting},data:function(){return{formData:{range_type:"0",sms_operator:"submail",zkg:!0},rules:{range_type:[{required:!1,message:this.$lang.type_cannot_be_empty,trigger:"change"}],sms_operator:[{required:!1,message:this.$lang.type_cannot_be_empty,trigger:"change"}],undefault:[]},range_typeOptions:[{label:this.$lang.domestic,value:"0"},{label:this.$lang.international,value:"1"}],sms_operatorOptions:[],sms_operatorOptionsAll:[],generated_invoiceOptions:[],pageDataArr:[],btnLoading:!1,gysShow:!1,testDialog:!1,submitLoading:!1,testSendFrom:{sms_operator:"aliyun",code:"+86",phone:""},sms_countryOptions:[],oldGysVal:"",gysTip:!1}},methods:{gysChange:function(){this.gysTip=!0},dataInit:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s,r,n,l,i,m;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(o["i"])("qhSure"==e?t.formData.sms_operator:"",t.formData.range_type);case 2:if(s=a.sent,r=s.data,200===r.status){a.next=7;break}return t.$message.error(r.msg),a.abrupt("return",!1);case 7:for(m in 0==r.range_type?(t.formData.zkg=1==r.sms_setting.shd_allow_sms_send,n=r.sms_setting.allowedSmsOperator.some((function(e){return e.label==r.sms_setting.sms_operator})),t.formData.sms_operator=n?r.sms_setting.sms_operator:void 0,t.oldGysVal=r.sms_setting.sms_operator):(t.formData.zkg=1==r.sms_setting.shd_allow_sms_send_global,l=r.sms_setting.allowedSmsOperator.some((function(e){return e.label==r.sms_setting.sms_operator_global})),t.formData.sms_operator=l?r.sms_setting.sms_operator_global:void 0,t.formData.sms_operator=r.sms_setting.sms_operator_global,t.oldGysVal=r.sms_setting.sms_operator_global),t.gysTip=!1,t.sms_operatorOptions=r.sms_setting.allowedSmsOperator,t.gysShow=!0,t.formData.range_type=r.range_type.toString(),t.generated_invoiceOptions=r.templates,(r.select_temp||[]).forEach((function(e){t.formData[e.type]=e.sms_temp_id})),i=r.message_template_lists,i)i[m]=i[m].reverse(),(i[m]||[]).forEach((function(e){(r.select_temp||[]).forEach((function(t){t.type===e.name&&(e.name_value=t.sms_temp_id,e.is_use_value=t.is_use)}))}));t.pageDataArr=i;case 17:case"end":return a.stop()}}),a)})))()},submitForm:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,s,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.formData.sms_operator,s=e.formData.shd_allow_sms_send,!e.$valIsNull(e.formData.sms_operator)){t.next=5;break}return e.$message.warning(e.$lang.select_suppliers),t.abrupt("return");case 5:for(r in e.pageDataArr)(e.pageDataArr[r]||[]).forEach((function(t){e.formData[t.name]=[t.name_value,t.is_use_value]}));return 0==e.formData.range_type?(e.$set(e.formData,"shd_allow_sms_send",e.formData.zkg?1:0),e.$set(e.formData,"sms_operator",e.formData.sms_operator)):(e.$set(e.formData,"shd_allow_sms_send_global",e.formData.zkg?1:0),e.$set(e.formData,"sms_operator_global",e.formData.sms_operator),e.$set(e.formData,"shd_allow_sms_send",s),e.$set(e.formData,"sms_operator",a)),e.btnLoading=!0,t.next=10,Object(o["m"])(e.formData);case 10:n=t.sent,200===n.data.status?(e.$message.success(n.data.msg),e.dataInit()):e.$message.error(n.data.msg),e.btnLoading=!1;case 13:case"end":return t.stop()}}),t)})))()},resetForm:function(){this.dataInit()},testSendPage:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={sms_operator:e.testSendFrom.sms_operator},t.next=3,Object(o["p"])(a);case 3:s=t.sent,r=s.data,200!==r.status?e.$message.error(r.msg):e.sms_countryOptions=r.sms;case 6:case"end":return t.stop()}}),t)})))()},testSend:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.testSendFrom.sms_operator=e.formData.sms_operator,e.submitLoading=!0,t.next=4,Object(o["j"])(e.testSendFrom);case 4:a=t.sent,s=a.data,200!==s.status?e.$message.error(s.msg):e.$message.success(s.msg),e.submitLoading=!1;case 8:case"end":return t.stop()}}),t)})))()}},created:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.dataInit();case 1:case"end":return t.stop()}}),t)})))()}},i=l,m=(a("f4b4"),a("2877")),c=Object(m["a"])(i,s,r,!1,null,"8f1d6b62",null);t["default"]=c.exports},6770:function(e,t,a){"use strict";a.d(t,"k",(function(){return r})),a.d(t,"l",(function(){return n})),a.d(t,"o",(function(){return o})),a.d(t,"n",(function(){return l})),a.d(t,"d",(function(){return i})),a.d(t,"i",(function(){return m})),a.d(t,"m",(function(){return c})),a.d(t,"q",(function(){return u})),a.d(t,"t",(function(){return p})),a.d(t,"s",(function(){return _})),a.d(t,"a",(function(){return g})),a.d(t,"c",(function(){return f})),a.d(t,"r",(function(){return d})),a.d(t,"b",(function(){return b})),a.d(t,"j",(function(){return h})),a.d(t,"p",(function(){return v})),a.d(t,"g",(function(){return y})),a.d(t,"e",(function(){return w})),a.d(t,"h",(function(){return D})),a.d(t,"f",(function(){return O}));var s=a("a27e");function r(){return Object(s["a"])({url:"config_message/config_mobile"})}function n(e){return Object(s["a"])({url:"config_message/config_mobile_post",method:"post",data:e})}function o(e){return Object(s["a"])({url:"config_message/template_list",method:"get",params:e})}function l(e,t){return Object(s["a"])({url:"config_message/delete_template",params:{ids:e,type:t}})}function i(e){return Object(s["a"])({url:"config_message/create_template",method:"post",data:e})}function m(e,t){return Object(s["a"])({url:"config_message/set_sms",params:{sms_operator:e,range_type:t}})}function c(e){return Object(s["a"])({url:"config_message/set_sms_post",method:"post",data:e})}function u(e){return Object(s["a"])({url:"config_message/test_message_template",method:"post",data:e})}function p(e){return Object(s["a"])({url:"config_message/update_template/".concat(e)})}function _(e){return Object(s["a"])({url:"config_message/update_template_post",method:"post",data:e})}function g(e){return Object(s["a"])({url:"config_message/test_message_template_page",params:e})}function f(){return Object(s["a"])({url:"config_message/create_template_page"})}function d(e){return Object(s["a"])({url:"config_message/update_tem_status",params:e})}function b(e,t){return Object(s["a"])({url:"config_message/check_post",method:"post",data:{ids:e,type:t}})}function h(e){return Object(s["a"])({url:"config_message/send_sms",method:"post",data:e})}function v(e){return Object(s["a"])({url:"config_message/test_message_template_page",params:e})}function y(e){return Object(s["a"])({url:"config_message/mobiletemplate_list",params:e})}function w(e){return Object(s["a"])({url:"email_template/emailtemplate_list",params:e})}function D(e){return Object(s["a"])({url:"config_message/sendmessage_post",method:"post",data:e})}function O(e){return Object(s["a"])({url:"config_message/get_template_desc",params:e})}},"9a29":function(e,t,a){},f4b4:function(e,t,a){"use strict";var s=a("9a29"),r=a.n(s);r.a}}]);