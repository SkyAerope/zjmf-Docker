(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["AddSupportTicket~f71cff67"],{"241f":function(t,e,r){"use strict";var n=r("a9cf"),a=r.n(n);a.a},"85e3":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("h2",[t._v(t._s(t.$lang.add_work_order))]),r("el-divider"),r("el-row",{staticClass:"topform_wrap"},[r("el-form",{ref:"addSupportTicketForm",attrs:{model:t.addSupportTicketFormData,rules:t.addSupportTicketFormRules,"label-width":t.labelWidth}},[r("div",{staticClass:"add-support-flex"},[r("el-form-item",{attrs:{label:t.$lang.client_name,prop:"username"}},[r("el-autocomplete",{style:{width:"260px"},attrs:{"trigger-on-focus":!0,size:"small","fetch-suggestions":t.querySearchAsync,placeholder:t.$lang.enter_associated_with_user},on:{input:t.clearUid,select:t.handleSelect},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.item;return[r("el-row",[r("el-col",{attrs:{span:24}},[r("span",{staticStyle:{"font-size":"14px"}},[t._v(t._s(n.username))]),r("span",[t._v(t._s(n.companyname?" ("+n.companyname+")":""))]),r("span",[t._v(t._s(n.id?" - #"+n.id:""))])]),r("el-col",{staticStyle:{"margin-top":"-10px"},attrs:{span:24}},[r("span",{staticStyle:{"font-size":"12px",color:"#999"}},[t._v(t._s(n.email))])])],1)]}}]),model:{value:t.addSupportTicketFormData.username,callback:function(e){t.$set(t.addSupportTicketFormData,"username",e)},expression:"addSupportTicketFormData.username"}})],1),r("el-form-item",{attrs:{label:t.$lang.processing_department,prop:"dptid"}},[r("span",{attrs:{slot:"label"},slot:"label"},[t._v(" "+t._s(t.$lang.processing_department)+" "),r("el-popover",{attrs:{placement:"top-start",title:"",width:"200",trigger:"hover"}},[r("el-row",[r("el-col",{attrs:{span:24}},[t._v(t._s(t.$lang.processing_department_hint))]),r("el-col",{staticClass:"tar",attrs:{span:24}},[r("router-link",{attrs:{to:{path:"work-order-dept"},target:"_blank"}},[r("el-link",{attrs:{type:"primary"}},[t._v(t._s(t.$lang.set_department))])],1)],1)],1),r("i",{staticClass:"el-icon-question blue_qus",attrs:{slot:"reference"},slot:"reference"})],1)],1),r("el-select",{style:{width:"260px"},attrs:{size:"small",placeholder:t.$lang.select_department,clearable:""},model:{value:t.addSupportTicketFormData.dptid,callback:function(e){t.$set(t.addSupportTicketFormData,"dptid",e)},expression:"addSupportTicketFormData.dptid"}},t._l(t.deptOptions,(function(t,e){return r("el-option",{key:e,attrs:{label:t.name,value:t.id}})})),1)],1),r("el-form-item",{attrs:{label:t.$lang.priority,prop:"priority"}},[r("el-select",{style:{width:"260px"},attrs:{size:"small",placeholder:t.$lang.select_priority,clearable:""},model:{value:t.addSupportTicketFormData.priority,callback:function(e){t.$set(t.addSupportTicketFormData,"priority",e)},expression:"addSupportTicketFormData.priority"}},t._l(t.priorityOptions,(function(t,e){return r("el-option",{key:e,attrs:{label:t.label,value:t.value,disabled:t.disabled}})})),1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:t.$lang.work_order_title,prop:"title"}},[r("el-input",{style:{width:"260px"},attrs:{size:"small",placeholder:t.$lang.enter_work_order_title,clearable:""},model:{value:t.addSupportTicketFormData.title,callback:function(e){t.$set(t.addSupportTicketFormData,"title",e)},expression:"addSupportTicketFormData.title"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:t.$lang.work_order_content,prop:"content"}},[r("tinymce-editor",{ref:"myQuillEditor",staticStyle:{width:"100%"},attrs:{tinymceValue:t.addSupportTicketFormData.content},on:{"update:tinymceValue":function(e){return t.$set(t.addSupportTicketFormData,"content",e)},"update:tinymce-value":function(e){return t.$set(t.addSupportTicketFormData,"content",e)}},model:{value:t.addSupportTicketFormData.content,callback:function(e){t.$set(t.addSupportTicketFormData,"content",e)},expression:"addSupportTicketFormData.content"}}),r("div",{directives:[{name:"show",rawName:"v-show",value:t.isEditorContentNull,expression:"isEditorContentNull"}],staticClass:"el-form-item__error"},[t._v(" "+t._s(t.$lang.enter_reply_content)+" ")])],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:t.$lang.attachment,prop:"attachment"}},[r("el-upload",{ref:"attachment",attrs:{"file-list":t.attachmentfileList,action:t.attachmentAction,"before-upload":t.attachmentBeforeUpload,"on-success":t.attachmentSuccessUpload,"with-credentials":"",multiple:"",name:"file"}},[r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-upload","on-error":t.uploadErr}},[t._v(t._s(t.$lang.click_upload))]),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(t._s(t.$lang.upload_size_hint))])],1)],1)],1)],1)],1)],1),r("div",{staticClass:"bottomOperationAdd"},[r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-plus",loading:t.btnLoading},on:{click:t.openTicketSubmit}},[t._v(t._s(t.$lang.open_order)+" ")]),r("el-button",{attrs:{size:"small"},on:{click:t.goBack}},[t._v(t._s(t.$lang.get_back))]),r("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.cancel}},[t._v(t._s(t.$lang.cancel))])],1)],1)},a=[],o=(r("4160"),r("b0c0"),r("a9e3"),r("159b"),r("96cf"),r("1da1")),i=r("af9c"),u=r("a200"),c={metaInfo:{title:window.zjmf_cw_lang.add_work_order},computed:{labelWidth:function(){var t=null;return t=window.document.body.clientWidth>768&&"US"===this.$lang.display_flag?"170px":window.document.body.clientWidth>768?"100px":null,t}},data:function(){return{uid:Number(this.$route.query.uid),id:0,customerObj:null,addSupportTicketFormData:{username:"",uid:void 0,email:void 0,send:0,cc:void 0,title:void 0,dptid:void 0,priority:"high",content:"",attachment:""},addSupportTicketFormRules:{content:[{required:!0,message:this.$lang.enter_reply_content,trigger:"blur"}],username:[{required:!0,message:this.$lang.select_client_name,trigger:"change"}],name:[],email:[],cc:[],title:[{required:!0,message:this.$lang.enter_work_order_title,trigger:"blur"}],dptid:[{required:!0,message:this.$lang.select_department,trigger:"change"}],priority:[]},customerOptions:[],deptOptions:[],priorityOptions:[{label:this.$lang.high,value:"high"},{label:this.$lang.centre,value:"medium"},{label:this.$lang.low,value:"low"}],attachmentAction:this.$baseUrl+"/upload_file",attachmentfileList:[],editorOption:{modules:{toolbar:{container:[["bold","italic","underline","strike"],["blockquote"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]]}}},isEditorContentNull:!1,btnLoading:!1}},methods:{clearUid:function(){this.addSupportTicketFormData.uid=""},handleSelect:function(t){"notFound"!==t.type&&(this.addSupportTicketFormData.username=t.username,this.addSupportTicketFormData.uid=t.id)},querySearchAsync:function(t,e){var r=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var a,o,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(i["f"])(t);case 2:if(a=n.sent,o=a.data,200===o.status){n.next=7;break}return r.$message.error(o.msg),n.abrupt("return");case 7:o.data.length?e(o.data):(u=[{username:r.$lang.no_relevant_data_could_be_found,type:"notFound"}],e(u));case 8:case"end":return n.stop()}}),n)})))()},uploadErr:function(t,e,r){},getAddPageInfoList:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["j"])();case 2:r=e.sent,n=r.data,200===n.status?(t.customerOptions=n.data.client,t.deptOptions=n.data.department,t.addSupportTicketFormData.dptid=t.deptOptions.length?t.deptOptions[0].id:void 0,(t.customerOptions||[]).forEach((function(e){t.uid===e.id&&(t.customerObj=e,t.customerSelectedChange(t.customerObj))})),t.addSupportTicketFormData.content=n.data.user.signature):t.$message.error(n.msg);case 5:case"end":return e.stop()}}),e)})))()},customerSelectedChange:function(t){this.addSupportTicketFormData.uid=t.id,this.addSupportTicketFormData.name=t.username,this.addSupportTicketFormData.email=t.email},onEditorReady:function(t){},onEditorBlur:function(){""===this.addSupportTicketFormData.content?this.isEditorContentNull=!0:this.isEditorContentNull=!1},onEditorFocus:function(){},onEditorChange:function(){},attachmentBeforeUpload:function(t){var e=t.size/1024/1024<10;return e||this.$message.error(this.$lang.file_size_over_ten_mb),e},attachmentSuccessUpload:function(t,e,r){this.attachmentfileList=r},openTicketSubmit:function(){var t=this;""===this.addSupportTicketFormData.content?this.isEditorContentNull=!0:this.isEditorContentNull=!1,this.addSupportTicketFormData.attachment=[],(this.attachmentfileList||[]).forEach((function(e){t.addSupportTicketFormData.attachment.push(e.response.data.savename)})),this.$refs.addSupportTicketForm.validate(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(r){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r&&!t.isEditorContentNull){e.next=4;break}return e.abrupt("return",!1);case 4:return t.btnLoading=!0,e.next=7,Object(u["b"])(t.addSupportTicketFormData);case 7:if(n=e.sent,a=n.data,200===a.status){e.next=13;break}t.$message.error(a.msg),e.next=18;break;case 13:if(t.$message.success(a.msg),!t.$route.query.uid){e.next=17;break}return t.$router.push({path:"/customer-view/tickets",query:{id:t.$route.query.uid}}),e.abrupt("return",!1);case 17:t.$router.go(-1);case 18:t.btnLoading=!1;case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},cancel:function(){this.$refs.addSupportTicketForm.resetFields()},goBack:function(){this.$router.go(-1)}},mounted:function(){this.getAddPageInfoList(),this.$route.query.uid&&(this.addSupportTicketFormData.username=sessionStorage.getItem("ticketsUsername"),this.addSupportTicketFormData.uid=this.$route.query.uid)}},s=c,l=(r("241f"),r("2877")),d=Object(l["a"])(s,n,a,!1,null,"1a92f09a",null);e["default"]=d.exports},a200:function(t,e,r){"use strict";r.d(e,"j",(function(){return a})),r.d(e,"b",(function(){return o})),r.d(e,"n",(function(){return i})),r.d(e,"q",(function(){return u})),r.d(e,"i",(function(){return c})),r.d(e,"p",(function(){return s})),r.d(e,"c",(function(){return l})),r.d(e,"f",(function(){return d})),r.d(e,"a",(function(){return p})),r.d(e,"d",(function(){return m})),r.d(e,"e",(function(){return f})),r.d(e,"g",(function(){return h})),r.d(e,"m",(function(){return _})),r.d(e,"h",(function(){return b})),r.d(e,"k",(function(){return g})),r.d(e,"l",(function(){return k})),r.d(e,"o",(function(){return v})),r.d(e,"s",(function(){return O})),r.d(e,"t",(function(){return y})),r.d(e,"u",(function(){return S})),r.d(e,"r",(function(){return j}));var n=r("a27e");function a(t){return Object(n["a"])({url:"add_ticket_page",params:t})}function o(t){return Object(n["a"])({url:"add_ticket",method:"post",data:t})}function i(t){return Object(n["a"])({url:"list_ticket",params:t})}function u(t){return Object(n["a"])({url:"reply_ticket",method:"post",data:t})}function c(t){return Object(n["a"])({url:"save_ticket_reply",method:"post",data:t})}function s(t){return Object(n["a"])({url:"merge_ticket",method:"post",data:t})}function l(t){return Object(n["a"])({url:"close_ticket",method:"post",data:t})}function d(t){return Object(n["a"])({url:"delete_ticket",method:"post",data:t})}function p(t){return Object(n["a"])({url:"add_ticket_note",method:"post",data:t})}function m(t){return Object(n["a"])({url:"delete_ticket_note",method:"post",data:t})}function f(t){return Object(n["a"])({url:"delete_ticket_reply",method:"post",data:t})}function h(t){return Object(n["a"])({url:"download_ticket_attachment",params:t})}function _(t){return Object(n["a"])({url:"list_ticket/"+t})}function b(t){return Object(n["a"])({url:"save_ticket",method:"post",data:t})}function g(){return Object(n["a"])({url:"getClient"})}function k(){return Object(n["a"])({url:"getTicketDepartment"})}function v(t){return Object(n["a"])({url:"hostbyuid",params:t})}function O(t){return Object(n["a"])({url:"ticket_receive",method:"put",data:t})}function y(t){return Object(n["a"])({url:"ticket_transfer_list",params:t})}function S(t){return Object(n["a"])({url:"ticket_transfer",method:"put",data:t})}function j(t){return Object(n["a"])({url:"tastes/editUserTanstes",method:"post",data:t})}},a9cf:function(t,e,r){},af9c:function(t,e,r){"use strict";r.d(e,"n",(function(){return a})),r.d(e,"m",(function(){return o})),r.d(e,"j",(function(){return i})),r.d(e,"a",(function(){return u})),r.d(e,"e",(function(){return c})),r.d(e,"q",(function(){return s})),r.d(e,"c",(function(){return l})),r.d(e,"k",(function(){return d})),r.d(e,"o",(function(){return p})),r.d(e,"l",(function(){return m})),r.d(e,"d",(function(){return f})),r.d(e,"p",(function(){return h})),r.d(e,"r",(function(){return _})),r.d(e,"b",(function(){return b})),r.d(e,"i",(function(){return g})),r.d(e,"f",(function(){return k})),r.d(e,"g",(function(){return v})),r.d(e,"h",(function(){return O}));var n=r("a27e");function a(t){return Object(n["a"])({url:"order/search_page",params:t})}function o(t){return Object(n["a"])({url:"order/search",params:t})}function i(t){return Object(n["a"])({url:"order/check",params:t})}function u(t){return Object(n["a"])({url:"order/cancel",params:t})}function c(t){return Object(n["a"])({url:"orders/delete",method:"delete",params:t})}function s(t){return Object(n["a"])({url:"order/create_page",params:t})}function l(t){return Object(n["a"])({url:"order/create",method:"post",data:t})}function d(t){return Object(n["a"])({url:"orders/"+t})}function p(t){return Object(n["a"])({url:"orders/set_config",params:t})}function m(t){return Object(n["a"])({url:"get_total",method:"post",data:t})}function f(t){return Object(n["a"])({url:"order/save_promo_code",method:"post",data:t})}function h(t){return Object(n["a"])({url:"orders/active",method:"post",data:t})}function _(){return Object(n["a"])({url:"order/promo_code_page"})}function b(t){return Object(n["a"])({url:"orders/change_status",method:"post",data:t})}function g(t){return Object(n["a"])({url:"order/order_commission",method:"post",data:t})}function k(t){return Object(n["a"])({url:"order/getclients",params:{username:t}})}function v(t){return Object(n["a"])({url:"invoice/renew",method:"get",params:t})}function O(t){return Object(n["a"])({url:"zjmf_finance_api/renew",method:"get",params:t})}}}]);