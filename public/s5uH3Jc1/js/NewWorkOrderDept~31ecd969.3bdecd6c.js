(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["NewWorkOrderDept~31ecd969"],{"13d5":function(e,t,a){"use strict";var r=a("23e7"),n=a("d58f").left,o=a("a640"),i=a("ae40"),s=o("reduce"),l=i("reduce",{1:0});r({target:"Array",proto:!0,forced:!s||!l},{reduce:function(e){return n(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"22fc":function(e,t,a){"use strict";a.d(t,"l",(function(){return n})),a.d(t,"i",(function(){return o})),a.d(t,"g",(function(){return i})),a.d(t,"k",(function(){return s})),a.d(t,"b",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"m",(function(){return d})),a.d(t,"n",(function(){return m})),a.d(t,"h",(function(){return f})),a.d(t,"a",(function(){return p})),a.d(t,"j",(function(){return _})),a.d(t,"e",(function(){return g})),a.d(t,"c",(function(){return b}));var r=a("a27e");function n(){return Object(r["a"])({url:"list_ticket_department"})}function o(){return Object(r["a"])({url:"get_ticket_deliver"})}function i(){return Object(r["a"])({url:"get_ticket_department"})}function s(e){return Object(r["a"])({url:"list_ticket_department/"+e})}function l(e){return Object(r["a"])({url:"add_ticket_department",method:"post",data:e})}function c(e){return Object(r["a"])({url:"save_ticket_department",method:"post",data:e})}function u(e){return Object(r["a"])({url:"delete_ticket_department",method:"post",data:e})}function d(e){return Object(r["a"])({url:"movedown_ticket_department",method:"post",data:e})}function m(e){return Object(r["a"])({url:"moveup_ticket_department",method:"post",data:e})}function f(e){return Object(r["a"])({url:"get_custom_param_type",method:"get",params:e})}function p(e){return Object(r["a"])({url:"add_ticket_custom_param",method:"get",params:e})}function _(e){return Object(r["a"])({url:"get_ticket_param_val",method:"get",params:e})}function g(e){return Object(r["a"])({url:"edit_ticket_custom_param",method:"get",params:e})}function b(e){return Object(r["a"])({url:"del_ticket_custom_param",method:"get",params:e})}},"2a89":function(e,t,a){},"2d9e":function(e,t,a){"use strict";var r=a("2a89"),n=a.n(r);n.a},"40ef":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h2",[e._v(e._s(e.orderId?e.$lang.editorial_department:e.$lang.add_a_new_department))]),a("el-row",{staticClass:"topform_wrap"},[a("el-form",{ref:"elForm",attrs:{model:e.formData,rules:e.rules,"label-width":"US"===e.$lang.display_flag?"200px":"110px"}},[a("el-tabs",{on:{"tab-click":e.tabClickHandler},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$lang.detail,name:"details"}},[a("el-form-item",{attrs:{label:e.$lang.department_name,prop:"name"}},[a("el-input",{style:{width:"260px"},attrs:{size:"small",placeholder:e.$lang.enter_department_name,clearable:""},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:e.$lang.describe,prop:"description"}},[a("el-input",{style:{width:"260px"},attrs:{size:"small",placeholder:e.$lang.enter_describe,clearable:""},model:{value:e.formData.description,callback:function(t){e.$set(e.formData,"description",t)},expression:"formData.description"}})],1),a("el-form-item",{attrs:{label:e.$lang.need_activate_product,prop:"is_product_order"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":e.$lang.open_create_work_order},model:{value:e.formData.is_product_order,callback:function(t){e.$set(e.formData,"is_product_order",t)},expression:"formData.is_product_order"}})],1),a("el-form-item",{attrs:{label:e.$lang.submit_need_realname,prop:"is_certifi"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":e.$lang.open_validate_realname},model:{value:e.formData.is_certifi,callback:function(t){e.$set(e.formData,"is_certifi",t)},expression:"formData.is_certifi"}})],1),a("el-form-item",{attrs:{label:e.$lang.auto_reply,prop:"is_open_auto_reply"}},[a("el-switch",{attrs:{"active-text":e.$lang.open_automatic_reply,"active-value":1,"inactive-value":0},model:{value:e.formData.is_open_auto_reply,callback:function(t){e.$set(e.formData,"is_open_auto_reply",t)},expression:"formData.is_open_auto_reply"}})],1),e.formData.is_open_auto_reply?[a("el-form-item",{attrs:{label:e.$lang.auto_reply_set}},[a("span",{staticStyle:{color:"#333","font-size":"12px"}},[e._v(e._s(e.$lang.auto_reply_will_reply_follow))])])]:e._e(),e.formData.is_open_auto_reply?[a("el-form-item",{attrs:{label:e.$lang.reply_content}},[a("el-input",{style:{width:"260px"},attrs:{type:"textarea",placeholder:e.$lang.enter_reply_content,maxlength:200,autosize:{minRows:5,maxRows:5},"show-word-limit":""},model:{value:e.formData.bz,callback:function(t){e.$set(e.formData,"bz",t)},expression:"formData.bz"}})],1)]:e._e(),a("el-form-item",{attrs:{label:e.$lang.repair_order_score,prop:"feedback_request"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":e.$lang.customer_can_score},model:{value:e.formData.feedback_request,callback:function(t){e.$set(e.formData,"feedback_request",t)},expression:"formData.feedback_request"}})],1),a("el-form-item",{attrs:{label:e.$lang.conceal,prop:"hidden"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":e.$lang.hide_user_center},model:{value:e.formData.hidden,callback:function(t){e.$set(e.formData,"hidden",t)},expression:"formData.hidden"}})],1)],2),e.orderId?a("el-tab-pane",{attrs:{label:e.$lang.custom_field,name:"fields"}},[a("el-row",{staticClass:"mt-10"},[a("el-col",{attrs:{md:24}},[a("el-button",{attrs:{size:"small",type:"success"},on:{click:e.addNewFields}},[a("i",{staticClass:"el-icon-plus"}),e._v(" "+e._s(e.$lang.add_fields)+" ")])],1)],1),a("el-table",{staticClass:"mt-10",staticStyle:{width:"100%"},attrs:{data:e.fieldsData,"default-sort":{prop:"id",order:"descending"},border:""}},[a("div",{attrs:{slot:"empty"},slot:"empty"},[!e.fieldsData.length&&e.tableLoading?a("span",[a("i",{staticClass:"el-icon-loading"}),e._v(" "+e._s(e.$lang.loading)+" ... ")]):e._e(),e.fieldsData.length||e.tableLoading?e._e():a("span",[e._v(e._s(e.$lang.no_data))])]),a("el-table-column",{attrs:{prop:"sortorder",label:e.$lang.sort}}),a("el-table-column",{attrs:{prop:"fieldname",label:e.$lang.field_name}}),a("el-table-column",{attrs:{prop:"fieldtype",label:e.$lang.filed_type}}),a("el-table-column",{attrs:{prop:"description",label:e.$lang.describe}}),a("el-table-column",{attrs:{prop:"regexpr",label:e.$lang.validation}}),a("el-table-column",{attrs:{prop:"fieldoptions",label:e.$lang.content}}),a("el-table-column",{attrs:{label:e.$lang.operation,width:"135",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"span-danger",attrs:{size:"small",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.deleteFields(t.row.id)}}},[e._v(e._s(e.$lang.delete))]),a("el-button",{staticClass:"span-primary",attrs:{size:"small",type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.updateFields(t.row.id)}}},[e._v(e._s(e.$lang.modification))])]}}],null,!1,3735511433)})],1)],1):e._e(),a("el-tab-pane",{attrs:{label:e.$lang.process_order_transfer,name:"pass"}},[a("el-form-item",{attrs:{label:e.$lang.connecting_upstream_department,prop:"hidden"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":e.$lang.can_pass_upstream},model:{value:e.formData.is_related_upstream,callback:function(t){e.$set(e.formData,"is_related_upstream",t)},expression:"formData.is_related_upstream"}})],1),1===e.formData.is_related_upstream?e._l(e.financeOptions,(function(t){return a("el-form-item",{key:t.id,attrs:{label:t.name}},[a("el-select",{attrs:{placeholder:e.$lang.please_choose},model:{value:e.formData.upstreams[t.id],callback:function(a){e.$set(e.formData.upstreams,t.id,a)},expression:"formData.upstreams[upstream.id]"}},e._l(t.children,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)})):e._e()],2)],1)],1)],1),a("div",{staticClass:"bottomOperationAdd"},[a("el-button",{attrs:{size:"small",type:"primary",loading:e.btnLoading},on:{click:e.submitForm}},[e._v(e._s(e.orderId?e.$lang.save_the_changes:e.$lang.add_a_new_department)+" ")]),a("el-button",{attrs:{size:"small"},on:{click:e.goBack}},[e._v(e._s(e.$lang.get_back))]),a("el-button",{attrs:{size:"small"},on:{click:e.resetForm}},[e._v(e._s(e.$lang.cancel))])],1)],1)},n=[],o=(a("a4d3"),a("e01a"),a("4160"),a("13d5"),a("a434"),a("b0c0"),a("159b"),a("96cf"),a("1da1")),i=a("22fc"),s=a("6a8e"),l={metaInfo:{title:window.zjmf_cw_lang.edit_work_order_department},data:function(){return{fieldsData:[],tableLoading:!1,orderId:this.$route.query.id,formData:{is_certifi:0,bz:this.$lang.receive_your_question,is_open_auto_reply:1,name:"",description:"",email:"test@qq.com",admins:[],is_product_order:0,feedback_request:1,hidden:0,host:"",port:"",login:"",password:"",is_related_upstream:"",customfieldname:[""],customsortorder:[0],customfieldtype:[""],customcfdesc:[""],customregexpr:[""],customfieldoptions:[""],customadminonly:[!1],customrequired:[!0],addfieldname:"",addsortorder:0,addfieldtype:"",addcfdesc:"",addregexpr:"",addfieldoptions:"",addadminonly:"",addrequired:"",upstreams:{}},rules:{name:[{required:!0,message:this.$lang.enter_department_name,trigger:"blur"}],description:[],is_open_auto_reply:[],email:[{required:!0,message:this.$lang.enter_email,trigger:"blur"},{required:!0,pattern:/^([0-9a-zA-Z]([-.\w]*[0-9a-zA-Z])*@(([0-9a-zA-Z])+([-\w]*[0-9a-zA-Z])*\.)+[a-zA-Z]{2,9})$/,message:this.$lang.enter_correct_email,trigger:"blur"}],admins:[],only_reg_client:[],feedback_request:[],hidden:[],host:[],port:[],login:[],password:[]},adminsOptions:[{id:1,user_login:"admin",user_nickname:"admin"}],financeOptions:[],activeName:sessionStorage.getItem("active-tab")?sessionStorage.getItem("active-tab"):"details",customfieldtypeOptions:[{label:this.$lang.the_text_box,value:"text"},{label:this.$lang.link_URL,value:"link"},{label:this.$lang.password,value:"password"},{label:this.$lang.dropdown,value:"dropdown"},{label:this.$lang.option_dialog,value:"tickbox"},{label:this.$lang.text_area,value:"textarea"}],btnLoading:!1}},methods:{tabClickHandler:function(e){sessionStorage.setItem("active-tab",e.name)},deleteFields:function(e){var t=this;this.$confirm(this.$lang.will_delete_file,this.$lang.hint,{confirmButtonText:this.$lang.confirm,cancelButtonText:this.$lang.cancel,type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(i["c"])({fieldId:e});case 2:r=a.sent,n=r.data,200===n.status?(t.$message.success(n.msg),t.getFormInfoById()):t.$message.error(n.msg);case 5:case"end":return a.stop()}}),a)})))).catch((function(){}))},updateFields:function(e){this.$router.push({path:"/add-custom-fields",query:{ticketId:this.$route.query.id,fieldId:e}})},addNewFields:function(){this.$router.push({path:"/add-custom-fields",query:{ticketId:this.$route.query.id}})},getFormInfo:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["g"])();case 2:a=t.sent,r=a.data,200===r.status?(e.adminsOptions=r.data.admin_list,e.financeOptions=r.data.zjmf_finance_api,e.getUpstreamConfigOptions()):e.$message({message:r.msg,type:"error"});case 5:case"end":return t.stop()}}),t)})))()},getFormInfoById:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableLoading=!0,t.next=3,Object(i["k"])(e.orderId);case 3:a=t.sent,r=a.data,200===r.status?((r.data.customfields.list||[]).forEach((function(e){e.adminonly=Boolean(e.adminonly),e.required=Boolean(e.required)})),e.fieldsData=r.data.customfields.list||[],e.tableLoading=!1,e.formData=r.data):(e.$message({message:r.msg,type:"error"}),e.tableLoading=!1);case 6:case"end":return t.stop()}}),t)})))()},deleteCustomerField:function(e){this.formData.customfields.splice(e,1)},submitForm:function(){var e=this;this.$refs.elForm.validate(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a){var r,n,o,s,l,c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=5;break}return e.$message.error(e.$lang.field_are_filled),t.abrupt("return",!1);case 5:if(1===e.formData.is_related_upstream)for(r in e.formData.upstreams)Object.hasOwnProperty.call(e.formData.upstreams,r)&&(n=e.formData.upstreams[r],n||delete e.formData.upstreams[r]);else delete e.formData.upstreams;if(e.orderId){t.next=16;break}return e.btnLoading=!0,t.next=10,Object(i["b"])(e.formData);case 10:o=t.sent,s=o.data,200===s.status?(e.$message({message:s.msg,type:"success"}),e.$router.push({path:"/work-order-dept"})):e.$message({message:s.msg,type:"error"}),e.btnLoading=!1,t.next=34;break;case 16:return e.formData.customfieldname=[],e.formData.customsortorder=[],e.formData.customfieldtype=[],e.formData.customcfdesc=[],e.formData.customregexpr=[],e.formData.customfieldoptions=[],e.formData.customadminonly=[],e.formData.customrequired=[],(e.formData.customfields.list||[]).forEach((function(t,a){e.formData.customfieldname[t.id]=t.fieldname,e.formData.customsortorder[t.id]=t.sortorder,e.formData.customfieldtype[t.id]=t.fieldtype,e.formData.customcfdesc[t.id]=t.description,e.formData.customregexpr[t.id]=t.regexpr,e.formData.customfieldoptions[t.id]=t.fieldoptions,e.formData.customadminonly[t.id]=t.adminonly,e.formData.customrequired[t.id]=t.required})),e.formData.customfields=[],l=e.$qs.stringify(e.formData,{arrayFormat:"indices"}),e.btnLoading=!0,t.next=30,Object(i["f"])(l);case 30:c=t.sent,u=c.data,200===u.status?(e.$message({message:u.msg,type:"success"}),e.$router.push({path:"/work-order-dept"})):e.$message({message:u.msg,type:"error"}),e.btnLoading=!1;case 34:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},resetForm:function(){this.$refs.elForm.resetFields()},goBack:function(){this.$router.go(-1)},getUpstreamConfigOptions:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.financeOptions.reduce((function(e,t){return e.push(t.id),e}),[]),t.next=3,Object(s["i"])(a);case 3:r=t.sent,n=r.data,(e.financeOptions||[]).forEach((function(t){e.$set(t,"children",n.upstream_ticket_departments[t.id]?n.upstream_ticket_departments[t.id].data.data:[]),e.$set(e.formData.upstreams,t.id,e.formData.upstreams[t.id]?e.formData.upstreams[t.id]:null)}));case 6:case"end":return t.stop()}}),t)})))()}},mounted:function(){this.getFormInfo(),this.orderId&&this.getFormInfoById()}},c=l,u=(a("2d9e"),a("2877")),d=Object(u["a"])(c,r,n,!1,null,"2d15bf9e",null);t["default"]=d.exports},"6a8e":function(e,t,a){"use strict";a.d(t,"f",(function(){return n})),a.d(t,"g",(function(){return o})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"j",(function(){return d})),a.d(t,"i",(function(){return m})),a.d(t,"a",(function(){return f}));var r=a("a27e");function n(e,t){return Object(r["a"])({url:"common/get_product_list",params:{type:e,id:t}})}function o(e){return Object(r["a"])({url:"common/get_promo_code",params:{type:e}})}function i(){return Object(r["a"])({url:"common/get_getways"})}function s(e){return Object(r["a"])({url:"common/get_email_tem",params:{type:e}})}function l(){return Object(r["a"])({url:"common/get_client_groups"})}function c(e){return Object(r["a"])({url:"common/host_list",params:{uid:e}})}function u(){return Object(r["a"])({url:"common/get_sms_country"})}function d(){return Object(r["a"])({url:"common/product_config_options"})}function m(e){return Object(r["a"])({url:"common/get_upstream_ticket_department_list",params:{id:e}})}function f(e){return Object(r["a"])({url:"check_product_as",method:"post",data:e})}},8418:function(e,t,a){"use strict";var r=a("c04e"),n=a("9bf2"),o=a("5c6c");e.exports=function(e,t,a){var i=r(t);i in e?n.f(e,i,o(0,a)):e[i]=a}},a434:function(e,t,a){"use strict";var r=a("23e7"),n=a("23cb"),o=a("a691"),i=a("50c4"),s=a("7b0b"),l=a("65f0"),c=a("8418"),u=a("1dde"),d=a("ae40"),m=u("splice"),f=d("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,_=Math.min,g=9007199254740991,b="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!m||!f},{splice:function(e,t){var a,r,u,d,m,f,h=s(this),v=i(h.length),$=n(e,v),y=arguments.length;if(0===y?a=r=0:1===y?(a=0,r=v-$):(a=y-2,r=_(p(o(t),0),v-$)),v+a-r>g)throw TypeError(b);for(u=l(h,r),d=0;d<r;d++)m=$+d,m in h&&c(u,d,h[m]);if(u.length=r,a<r){for(d=$;d<v-r;d++)m=d+r,f=d+a,m in h?h[f]=h[m]:delete h[f];for(d=v;d>v-r+a;d--)delete h[d-1]}else if(a>r)for(d=v-r;d>$;d--)m=d+r-1,f=d+a-1,m in h?h[f]=h[m]:delete h[f];for(d=0;d<a;d++)h[d+$]=arguments[d+2];return h.length=v-r+a,u}})},d58f:function(e,t,a){var r=a("1c0b"),n=a("7b0b"),o=a("44ad"),i=a("50c4"),s=function(e){return function(t,a,s,l){r(a);var c=n(t),u=o(c),d=i(c.length),m=e?d-1:0,f=e?-1:1;if(s<2)while(1){if(m in u){l=u[m],m+=f;break}if(m+=f,e?m<0:d<=m)throw TypeError("Reduce of empty array with no initial value")}for(;e?m>=0:d>m;m+=f)m in u&&(l=a(l,u[m],m,c));return l}};e.exports={left:s(!1),right:s(!0)}}}]);