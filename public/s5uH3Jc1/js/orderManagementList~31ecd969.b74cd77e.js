(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["orderManagementList~31ecd969"],{"129f":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"2a86":function(e,t,a){},"4c53":function(e,t,a){"use strict";var r=a("23e7"),n=a("857a"),o=a("af03");r({target:"String",proto:!0,forced:o("sub")},{sub:function(){return n(this,"sub","","")}})},"6012c":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"custom-tabs"},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"订单",name:"first"}},["first"==e.activeName?a("OrderDetail"):e._e()],1),a("el-tab-pane",{attrs:{label:"续费订单",name:"second"}},["second"==e.activeName?a("RenewOrder"):e._e()],1)],1)],1)},n=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mt-10"},[a("h2",[e._v("订单管理列表")]),a("div",{staticClass:"mb-20 list_header"},[a("div",[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.showSearchArea=!e.showSearchArea}}},[e._v(e._s(e.showSearchArea?"收起搜索":"高级搜索"))])],1)]),a("transition",{attrs:{name:"el-zoom-in-top"}},[e.showSearchArea?a("el-form",{ref:"elForm",staticClass:"mt-20 mb-20 unfold-search",attrs:{inline:"",model:e.search,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"订单ID"}},[a("el-input",{style:{width:"200px"},attrs:{size:"small",placeholder:"请输入订单id",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchHandeClick(t)}},model:{value:e.search.id,callback:function(t){e.$set(e.search,"id",t)},expression:"search.id"}})],1),a("el-form-item",{attrs:{label:"商品名称/主机名"}},[a("el-input",{style:{width:"200px"},attrs:{size:"small",placeholder:"请输入商品名称/主机名",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchHandeClick(t)}},model:{value:e.search.name,callback:function(t){e.$set(e.search,"name",t)},expression:"search.name"}})],1),a("el-form-item",{attrs:{label:"订单状态"}},[a("el-select",{style:{width:"200px"},attrs:{size:"small",placeholder:"请选择订单状态",clearable:""},model:{value:e.search.order_status,callback:function(t){e.$set(e.search,"order_status",t)},expression:"search.order_status"}},e._l(e.orderStatus,(function(t,r){return a("el-option",{key:r,attrs:{label:t.name,value:r}},[a("span",{style:{color:t.color}},[e._v(e._s(t.name))])])})),1)],1),a("el-form-item",{attrs:{label:"订单类型"}},[a("el-select",{style:{width:"200px"},attrs:{size:"small",placeholder:"请选择订单类型",clearable:""},model:{value:e.search.order_type,callback:function(t){e.$set(e.search,"order_type",t)},expression:"search.order_type"}},e._l(e.orderType,(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})})),1)],1),a("el-form-item",{attrs:{label:"金额"}},[a("el-input",{style:{width:"200px"},attrs:{size:"small",placeholder:"请输入金额",clearable:""},model:{value:e.search.amount,callback:function(t){e.$set(e.search,"amount",t)},expression:"search.amount"}})],1),a("el-form-item",{attrs:{label:"订购时间",prop:"time"}},[a("el-date-picker",{style:{width:"350px"},attrs:{size:"small",type:"datetimerange","value-format":"timestamp","start-placeholder":"开始时间","end-placeholder":"结束时间","range-separator":"~",clearable:""},on:{change:e.dateSelectChange},model:{value:e.searchTime,callback:function(t){e.searchTime=t},expression:"searchTime"}})],1),a("el-form-item",{attrs:{label:" "}},[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-search",loading:e.tableLoading},on:{click:e.handleSearch}},[e._v("搜索")]),a("el-button",{attrs:{size:"mini",icon:"el-icon-delete",loading:e.tableLoading},on:{click:e.handleDelete}},[e._v("清空")])],1)],1):e._e()],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.tableList,border:""}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.local_id?a("router-link",{attrs:{to:{path:"/order-detail",query:{id:r.local_id}}}},[a("el-link",[e._v(e._s(r.id))])],1):a("span",[e._v(e._s(r.id))])]}}])}),a("el-table-column",{attrs:{prop:"active_type",label:"商品",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.name?a("el-popover",{attrs:{placement:"top-start",trigger:"hover"}},[a("el-form",{attrs:{"label-position":"right","label-width":"68px"}},[a("el-form-item",{staticStyle:{margin:"0 !important"},attrs:{label:"商品名称:"}},[a("span",[e._v(e._s(r.name))])]),a("el-form-item",{staticStyle:{margin:"0 !important"},attrs:{label:"主机名:"}},[e._v(" "+e._s(r.domain)+" ")])],1),a("div",{attrs:{slot:"reference"},slot:"reference"},[r.hosts[0]?a("div",[r.local_uid&&r.local_hostid?a("el-link",{attrs:{href:"#/customer-view/product-innerpage??id="+r.local_uid+"&hid="+r.local_hostid}},[e._v(e._s(r.local_name))]):a("span",[e._v(e._s(r.name))])],1):e._e()])],1):a("span",[e._v("-")])]}}])}),a("el-table-column",{attrs:{prop:"product_type",label:"产品类型",align:"center"}}),a("el-table-column",{attrs:{prop:"dedicatedip",label:"IP",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.dedicatedip?a("span",[e._v(e._s(r.dedicatedip))]):a("span",[e._v("-")])]}}])}),a("el-table-column",{attrs:{prop:"supplier_username",label:"卖家",align:"center"}}),a("el-table-column",{attrs:{prop:"agent_username",label:"用户",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.local_username&&r.local_uid?a("el-link",{attrs:{href:"#/customer-view/abstract?id="+r.local_uid}},[e._v(e._s(r.local_username))]):a("span",[e._v(e._s(r.local_username))])]}}])}),a("el-table-column",{attrs:{prop:"active_type",label:"订单状态/产品状态",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.order_status&&"退款失败"==r.order_status.name?a("el-popover",{attrs:{placement:"top-start",title:"失败原因",trigger:"hover",content:r.refund_fail_reason}},[a("div",{attrs:{slot:"reference"},slot:"reference"},[r.order_status?a("span",{style:{color:r.order_status.color}},[e._v(e._s(r.order_status.name))]):e._e()])]):a("div",[r.order_status?a("span",{style:{color:r.order_status.color}},[e._v(e._s(r.order_status.name))]):e._e()])]}}])}),a("el-table-column",{attrs:{prop:"active_type",label:"订购时间",align:"center",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(0===t.row.create_time?"-":e.$moment(1e3*t.row.create_time).format("YYYY-MM-DD HH:mm:ss")))])]}}])}),a("el-table-column",{attrs:{prop:"invoice_type_zh",label:"订单类型",align:"center"}}),a("el-table-column",{attrs:{prop:"active_type",label:"金额",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-popover",{attrs:{placement:"top-start",trigger:"hover"}},[a("div",[a("p",{staticStyle:{margin:"0"}},[e._v("相对汇率:"),a("span",{staticClass:"ml-5",staticStyle:{"font-weight":"bold"}},[e._v(e._s(Number(r.current_rate).toFixed(4)))])]),a("p",{staticStyle:{margin:"0"}},[e._v("资源池金额:"),a("span",{staticClass:"ml-5",staticStyle:{"font-weight":"bold"}},[e._v(e._s(r.resource_amount))])])]),a("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(r.local_amount))])])]}}])}),a("el-table-column",{attrs:{label:"利润",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("div",[a("span",[e._v(e._s(r.local_profit))])])]}}])}),a("el-table-column",{attrs:{prop:"payment",label:"付款方式",align:"center"}}),a("el-table-column",{attrs:{label:"操作",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return["信用额支付"!=r.payment&&"Refunding"!=r.status&&"Refunded"!=r.status&&r.invoiceid&&1==r.allow_refund?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.refund(r)}}},[e._v("退款")]):e._e(),r.r_status?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.$router.push({path:"refund-detail",query:{id:r.invoiceid}})}}},[e._v("退款详情")]):e._e(),e.$valIsNull(r.after_sale.id)?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.applyAftersale(r)}}},[e._v("申请售后")]):a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.$router.push({path:"aftersale-detail",query:{id:r.after_sale.id}})}}},[e._v("售后详情")]),e.$valIsNull(r.after_sale.id)||"Cancelled"==r.after_sale.status?e._e():a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.revoke(r)}}},[e._v("撤销申请")]),1!=r.sign_for_status||r.evaluation_id?e._e():a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleIsEvaluation(r)}}},[e._v("评价")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.search.page,"page-sizes":[10,15,20,25,50,100],"page-size":e.search.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.getData,"update:currentPage":function(t){return e.$set(e.search,"page",t)},"update:current-page":function(t){return e.$set(e.search,"page",t)},"update:pageSize":function(t){return e.$set(e.search,"limit",t)},"update:page-size":function(t){return e.$set(e.search,"limit",t)}}}),a("el-dialog",{attrs:{title:"退款",visible:e.DialogVisiable,width:"500px"},on:{"update:visible":function(t){e.DialogVisiable=t},closed:e.resetForm}},[a("el-form",{ref:"refundForm",attrs:{model:e.formData,rules:e.rules,"label-width":"100px"}},[a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{xs:24}},[a("el-form-item",{attrs:{label:"订单号："}},[a("span",[e._v(e._s(e.formData.invoiceid))])])],1),a("el-col",{attrs:{xs:24}},[a("el-form-item",{attrs:{label:"商品名称："}},[a("span",[e._v(e._s(e.formData.name))])])],1),a("el-col",{attrs:{xs:24}},[a("el-form-item",{attrs:{label:"退款金额：",prop:"amount"}},[a("el-input",{style:{width:"100%"},attrs:{size:"small",placeholder:""==e.formData.amount?"请输入退款金额":parseFloat(e.diff_amount)>e.formData.amount?"超出":"请输入退款金额"},model:{value:e.formData.amount,callback:function(t){e.$set(e.formData,"amount",t)},expression:"formData.amount"}})],1)],1),a("el-col",{attrs:{xs:24}},[a("el-form-item",{attrs:{label:"退款原因：",prop:"refundReason"}},[a("el-input",{style:{width:"100%"},attrs:{size:"small",type:"textarea",placeholder:"请输入退款原因"},model:{value:e.formData.refundReason,callback:function(t){e.$set(e.formData,"refundReason",t)},expression:"formData.refundReason"}})],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.DialogVisiable=!1}}},[e._v("取消")]),a("el-button",{attrs:{size:"small",type:"primary",loading:e.btnloding},on:{click:e.submitForm}},[e._v("确定")])],1)],1),a("el-dialog",{attrs:{title:"申请平台介入",visible:e.DialogVisiableTwo,width:"500px"},on:{"update:visible":function(t){e.DialogVisiableTwo=t},closed:e.resetForm}},[a("el-form",{ref:"interventionForm",attrs:{model:e.formData,rules:e.rules,"label-width":"100px"}},[a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{xs:24}},[a("el-form-item",{attrs:{label:"订单号："}},[a("span",[e._v(e._s(e.formData.orderNum))])])],1),a("el-col",{attrs:{xs:24}},[a("el-form-item",{attrs:{label:"商品名称："}},[a("span",[e._v(e._s(e.formData.name))])])],1),a("el-col",{attrs:{xs:24}},[a("el-form-item",{attrs:{label:"申请原因：",prop:"applyReason"}},[a("el-input",{style:{width:"100%"},attrs:{size:"small",type:"textarea",placeholder:"请输入申请原因"},model:{value:e.formData.applyReason,callback:function(t){e.$set(e.formData,"applyReason",e._n(t))},expression:"formData.applyReason"}})],1)],1),a("el-col",{attrs:{xs:24}},[a("el-form-item",{attrs:{label:"上传图片："}},[a("el-upload",{ref:"afterUpload",attrs:{action:e.uploadAction,name:"image","list-type":"picture-card","with-credentials":!0,"on-success":e.handleUploadSuccessAgent,"on-remove":e.handleUploadRemovAgent}},[a("i",{staticClass:"el-icon-plus"})])],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",loading:e.btnloding},on:{click:e.submitFormTwo}},[e._v("确定")]),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.DialogVisiableTwo=!1}}},[e._v("取消")])],1)],1),a("el-dialog",{attrs:{title:"商品评价",visible:e.evaluationDialogVisible,width:"25%"},on:{"update:visible":function(t){e.evaluationDialogVisible=t},closed:function(t){return e.handleEvaluateDialogVisibleClosed("evaluateRef")}}},[a("el-form",{ref:"evaluateRef",attrs:{size:"small","label-width":"80px","label-position":"top",model:e.evaluationForm,rules:e.evaluateReles}},[a("el-form-item",{attrs:{label:"店铺名称"}},[a("span",[e._v(e._s(e.evaluationForm.supplier_username))])]),a("el-form-item",{attrs:{label:"评价",prop:"type"}},[a("el-radio-group",{model:{value:e.evaluationForm.type,callback:function(t){e.$set(e.evaluationForm,"type",t)},expression:"evaluationForm.type"}},[a("el-radio",{attrs:{label:"great"}},[e._v("好评")]),a("el-radio",{attrs:{label:"middle"}},[e._v("中评")]),a("el-radio",{attrs:{label:"bad"}},[e._v("差评")])],1)],1),a("el-form-item",{attrs:{label:"综合评价",prop:"score"}},[a("el-rate",{model:{value:e.evaluationForm.score,callback:function(t){e.$set(e.evaluationForm,"score",t)},expression:"evaluationForm.score"}})],1),a("el-form-item",{attrs:{label:"网络质量",prop:"netword_score"}},[a("el-rate",{model:{value:e.evaluationForm.netword_score,callback:function(t){e.$set(e.evaluationForm,"netword_score",t)},expression:"evaluationForm.netword_score"}})],1),a("el-form-item",{attrs:{label:"硬件年限",prop:"hardware_score"}},[a("el-rate",{model:{value:e.evaluationForm.hardware_score,callback:function(t){e.$set(e.evaluationForm,"hardware_score",t)},expression:"evaluationForm.hardware_score"}})],1),a("el-form-item",{attrs:{label:"评价内容",prop:"content"}},[a("el-input",{attrs:{type:"textarea",rows:"5",maxlength:"100","show-word-limit":""},model:{value:e.evaluationForm.content,callback:function(t){e.$set(e.evaluationForm,"content",t)},expression:"evaluationForm.content"}})],1),a("el-form-item",{attrs:{label:"上传图片"}},[a("el-upload",{ref:"evaluateUpload",attrs:{action:e.uploadAction,name:"image","list-type":"picture","with-credentials":!0,"on-success":e.handleUploadSuccessEvaluate,"on-remove":e.handleUploadRemovEvaluate}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("格式支持PNG、JPG、GIF")])],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEvaluation("evaluateRef")}}},[e._v("保存")]),a("el-button",{on:{click:function(t){e.evaluationDialogVisible=!1}}},[e._v("取消")])],1)],1)],1)},i=[],l=(a("c740"),a("b0c0"),a("a9e3"),a("ac1f"),a("841c"),a("4c53"),a("96cf"),a("1da1")),s=a("db75"),u={data:function(){var e=this,t=function(t,a,r){a>e.diff_amount&&r(new Error("可退款金额不足")),r()};return{uploadAction:this.$baseUrl+"/agent/upload",showSearchArea:!1,orderStatus:[],orderType:[],supplier:[],searchTime:[],search:{page:1,limit:Number(localStorage.getItem("limit"))||50,order:"id",sort:"DESC",type:"order_type",id:void 0,name:void 0,order_status:void 0,order_type:void 0,amount:void 0,supplier:void 0,start_time:void 0,end_time:void 0},searchOptions:[{label:"全部",value:"all"}],tableList:[],tableLoading:!1,total:0,DialogVisiable:!1,formData:{invoiceid:void 0,orderNum:void 0,name:void 0,amount:void 0,subtotal:void 0,refundReason:void 0,applyReason:void 0,agent_img:[]},rules:{amount:[{required:!0,message:"请输入退款金额",trigger:"blur"},{validator:t,trigger:"blur"}],refundReason:[{required:!0,message:"请输入退款原因",trigger:"blur"}],applyReason:[{required:!0,message:"请输入售后原因",trigger:"blur"}]},diff_amount:0,DialogVisiableTwo:!1,btnloding:!1,evaluationDialogVisible:!1,evaluationForm:{supplier_username:void 0,id:void 0,content:void 0,type:void 0,score:void 0,netword_score:void 0,hardware_score:void 0,img:[]},evaluateReles:{content:[{required:!0,message:"请输入评价内容",trigger:"blur"}],type:[{required:!0,message:"请选择评价",trigger:"change"}],score:[{required:!0,message:"请选择综合评价",trigger:"change"}],netword_score:[{required:!0,message:"请选择网络质量评价",trigger:"change"}],hardware_score:[{required:!0,message:"请选择硬件年限评价",trigger:"change"}]}}},mounted:function(){this.getData(!0),this.getSearchStatus()},methods:{handleDelete:function(){this.search.id=void 0,this.search.name=void 0,this.search.order_status=void 0,this.search.order_type=void 0,this.search.amount=void 0,this.search.supplier=void 0,this.search.start_time=void 0,this.search.end_time=void 0,this.searchTime=[]},handleSearch:function(){for(var e in this.search)this.search[e]||(this.search[e]=void 0);this.getData()},dateSelectChange:function(e){e?(this.search.start_time=e[0]/1e3,this.search.end_time=e[1]/1e3):(this.search.start_time=void 0,this.search.end_time=void 0)},getSearchStatus:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["v"])();case 2:if(a=t.sent,r=a.data,200===r.status){t.next=6;break}return t.abrupt("return",e.$message.error(r.msg));case 6:e.orderStatus=r.data.order_status,e.orderType=r.data.order_type,e.supplier=r.data.supplier;case 9:case"end":return t.stop()}}),t)})))()},revoke:function(e){var t=this;this.$confirm("是否撤销申请",this.$lang.hint,{confirmButtonText:this.$lang.confirm,cancelButtonText:this.$lang.cancel,type:"warning"}).then((function(){Object(s["x"])({id:e.id}).then((function(e){200==e.data.status?(t.$message.success(e.data.msg),t.getData()):t.$message.error(e.data.msg)}))}))},handleUploadRemovAgent:function(e){if(200!==e.response.status)return this.$message.error(e.msg);this.$delete(this.formData.agent_img,this.formData.agent_img.findIndex((function(t){return t==e.response.savename})))},handleUploadSuccessAgent:function(e){if(200!==e.status)return this.$message.error(e.msg);this.formData.agent_img.push(e.savename)},submitFormTwo:function(){var e=this,t={orderid:this.formData.orderNum,reason:this.formData.applyReason,agent_img:this.formData.agent_img};this.$refs.interventionForm.validate(function(){var a=Object(l["a"])(regeneratorRuntime.mark((function a(r){var n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!r){a.next=15;break}return e.btnloding=!0,a.next=4,Object(s["b"])(t);case 4:if(n=a.sent,o=n.data,e.btnloding=!1,200!=o.status){a.next=14;break}e.$message.success(o.msg),e.$refs.afterUpload.clearFiles(),e.DialogVisiableTwo=!1,e.getData(),a.next=15;break;case 14:return a.abrupt("return",e.$message.error(o.msg));case 15:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())},applyAftersale:function(e){this.formData.orderNum=e.id,this.formData.name=e.name,this.DialogVisiableTwo=!0},submitForm:function(){var e=this,t={invoiceid:this.formData.invoiceid,amount:this.formData.amount,subtotal:this.formData.subtotal,refund_reason:this.formData.refundReason};this.$refs.refundForm.validate(function(){var a=Object(l["a"])(regeneratorRuntime.mark((function a(r){var n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!r){a.next=14;break}return e.btnloding=!0,a.next=4,Object(s["o"])(t);case 4:if(n=a.sent,o=n.data,e.btnloding=!1,200!=o.status){a.next=13;break}e.$message.success(o.msg),e.DialogVisiable=!1,e.getData(),a.next=14;break;case 13:return a.abrupt("return",e.$message.error(o.msg));case 14:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())},resetForm:function(){this.formData={orderNum:"",name:"",invoiceid:void 0,subtotal:void 0,amount:void 0,refundReason:"",applyReason:""},this.diff_amount=0,this.$valIsNull(this.evaluationForm.img)||this.$refs.afterUpload.clearFiles(),this.$refs.refundForm&&this.$refs.refundForm.resetFields(),this.$refs.interventionForm&&this.$refs.interventionForm.resetFields()},refund:function(e){this.formData.invoiceid=e.invoiceid,this.formData.name=e.name,this.formData.amount=Number(e.sub),this.formData.subtotal=Number(e.sub),this.diff_amount=Number(e.sub),this.DialogVisiable=!0},getData:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var r,n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.tableLoading=!0,a.next=3,Object(s["e"])(t.search);case 3:if(r=a.sent,n=r.data,200===n.status){if(t.tableList=n.data.rows,t.total=n.data.count,t.tableLoading=!1,e)for(o in n.data.type)"all"!=o&&t.searchOptions.push({label:n.data.type[o],value:o})}else t.tableLoading=!1,t.$message.error(n.msg);case 6:case"end":return a.stop()}}),a)})))()},handleSizeChange:function(){this.search.page=1,this.getData()},handleIsEvaluation:function(e){this.evaluationForm.id=e.invoiceid,this.evaluationForm.supplier_username=e.supplier_username,this.evaluationDialogVisible=!0},handleUploadSuccessEvaluate:function(e){if(200!==e.status)return this.$message.error(data.msg);this.evaluationForm.img.push(e.savename)},handleUploadRemovEvaluate:function(e){if(200!==e.response.status)return this.$message.error("移除图片有误");this.$delete(this.evaluationForm.img,this.evaluationForm.img.findIndex((function(t){return t==e.response.savename})))},handleEvaluation:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(a){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=14;break}return delete t.evaluationForm.supplier_username,e.next=4,Object(s["j"])(t.evaluationForm);case 4:if(r=e.sent,n=r.data,200===n.status){e.next=8;break}return e.abrupt("return",t.$message.error(n.msg));case 8:t.$message.success(n.msg),t.getData(),t.$refs.evaluateUpload.clearFiles(),t.evaluationDialogVisible=!1,e.next=15;break;case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},handleEvaluateDialogVisibleClosed:function(e){this.evaluationForm.id=void 0,this.evaluationForm.supplier_username=void 0,this.evaluationForm.content=void 0,this.evaluationForm.type=void 0,this.evaluationForm.score=void 0,this.evaluationForm.netword_score=void 0,this.evaluationForm.hardware_score=void 0,this.evaluationForm.img=[],this.$refs.evaluateUpload.clearFiles(),this.$refs[e].resetFields()}}},c=u,d=(a("bf7b"),a("2877")),m=Object(d["a"])(c,o,i,!1,null,"5ef01862",null),p=m.exports,f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mt-10"},[a("el-row",[a("el-col",[a("h2",[e._v("续费订单管理列表")])])],1),a("div",{staticClass:"mb-20 list_header"},[a("div",[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.showSearchArea=!e.showSearchArea}}},[e._v(e._s(e.showSearchArea?"收起搜索":"高级搜索"))])],1)]),a("transition",{attrs:{name:"el-zoom-in-top"}},[e.showSearchArea?a("el-form",{ref:"elForm",staticClass:"mt-20 mb-20 unfold-search",attrs:{inline:"",model:e.formData,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"订单ID"}},[a("el-input",{style:{width:"200px"},attrs:{size:"small",placeholder:"请输入订单id",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchHandeClick(t)}},model:{value:e.formData.id,callback:function(t){e.$set(e.formData,"id",t)},expression:"formData.id"}})],1),a("el-form-item",{attrs:{label:"商品名称/主机名"}},[a("el-input",{style:{width:"200px"},attrs:{size:"small",placeholder:"请输入商品名称/主机名",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchHandeClick(t)}},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"金额"}},[a("el-input",{style:{width:"200px"},attrs:{size:"small",placeholder:"请输入金额",clearable:""},model:{value:e.formData.amount,callback:function(t){e.$set(e.formData,"amount",t)},expression:"formData.amount"}})],1),a("el-form-item",{attrs:{label:"订购时间",prop:"time"}},[a("el-date-picker",{style:{width:"350px"},attrs:{size:"small",type:"datetimerange","value-format":"timestamp","start-placeholder":"开始时间","end-placeholder":"结束时间","range-separator":"~",clearable:""},on:{change:e.dateSelectChange},model:{value:e.searchTime,callback:function(t){e.searchTime=t},expression:"searchTime"}})],1),a("el-form-item",{attrs:{label:" "}},[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-search",loading:e.tableLoading},on:{click:e.handleSearch}},[e._v("搜索")]),a("el-button",{attrs:{size:"mini",icon:"el-icon-delete",loading:e.tableLoading},on:{click:e.handleDelete}},[e._v("重置")])],1)],1):e._e()],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{label:"ID",prop:"id",width:"70",align:"center"}}),a("el-table-column",{attrs:{label:"商品",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.name?a("el-popover",{attrs:{placement:"top-start",trigger:"hover"}},[a("el-form",{attrs:{"label-position":"right","label-width":"68px"}},[a("el-form-item",{staticStyle:{margin:"0 !important"},attrs:{label:"商品名称:"}},[a("span",[e._v(e._s(r.name))])]),a("el-form-item",{staticStyle:{margin:"0 !important"},attrs:{label:"主机名:"}},[e._v(" "+e._s(r.domain)+" ")])],1),a("div",{attrs:{slot:"reference"},slot:"reference"},[a("div",[r.local_uid&&r.local_hostid?a("el-link",{attrs:{href:"#/customer-view/product-innerpage??id="+r.local_uid+"&hid="+r.local_hostid}},[e._v(e._s(r.local_name))]):a("span",[e._v(e._s(r.name))])],1)])],1):a("span",[e._v("-")])]}}])}),a("el-table-column",{attrs:{label:"产品类型",prop:"product_type",align:"center"}}),a("el-table-column",{attrs:{label:"IP",prop:"dedicatedip",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.dedicatedip?a("span",[e._v(e._s(r.dedicatedip))]):a("span",[e._v("-")])]}}])}),a("el-table-column",{attrs:{label:"卖家",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(r.supplier_username))])]}}])}),a("el-table-column",{attrs:{label:"用户",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.local_username&&r.local_uid?a("el-link",{attrs:{href:"#/customer-view/abstract?id="+r.local_uid}},[e._v(e._s(r.local_username))]):a("span",[e._v(e._s(r.local_username))])]}}])}),a("el-table-column",{attrs:{label:"续费时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(0===r.paid_time?"-":e.$moment(1e3*r.paid_time).format("YYYY-MM-DD HH:mm:ss")))])]}}])}),a("el-table-column",{attrs:{label:"金额",prop:"amount",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("el-popover",{attrs:{placement:"top-start",trigger:"hover"}},[a("div",[a("p",{staticStyle:{margin:"0"}},[e._v("相对汇率:"),a("span",{staticClass:"ml-5",staticStyle:{"font-weight":"bold"}},[e._v(e._s(Number(r.current_rate).toFixed(4)))])]),a("p",{staticStyle:{margin:"0"}},[e._v("资源池金额:"),a("span",{staticClass:"ml-5",staticStyle:{"font-weight":"bold"}},[e._v(e._s(r.resource_amount))])])]),a("span",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(r.local_amount))])])]}}])}),a("el-table-column",{attrs:{label:"利润",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[a("span",[e._v(e._s(r.local_profit))])]}}])}),a("el-table-column",{attrs:{label:"付款方式",prop:"payment",align:"center"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[1!=r.sign_for_status||r.evaluation_id?e._e():a("el-link",{on:{click:function(t){return e.handleIsEvaluation(r)}}},[e._v("评价")])]}}])})],1),a("el-pagination",{staticClass:"mt-10",attrs:{layout:"total, sizes, prev, pager, next, jumper",disabled:e.tableLoading,total:e.total,"page-size":e.formData.limit,"current-page":e.formData.page,"page-sizes":[10,15,20,25,50,100]},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{title:"评价",visible:e.evaluationDialogVisible,width:"30%"},on:{"update:visible":function(t){e.evaluationDialogVisible=t},closed:function(t){return e.handleEvaluateDialogVisibleClosed("evaluateRef")}}},[a("el-form",{ref:"evaluateRef",attrs:{size:"small","label-width":"80px","label-position":"top",model:e.evaluationForm,rules:e.evaluateReles}},[a("el-form-item",{attrs:{label:"店铺名称"}},[a("span",[e._v(e._s(e.evaluationForm.supplier_username))])]),a("el-form-item",{attrs:{label:"评价",prop:"type"}},[a("el-radio-group",{model:{value:e.evaluationForm.type,callback:function(t){e.$set(e.evaluationForm,"type",t)},expression:"evaluationForm.type"}},[a("el-radio",{attrs:{label:"great"}},[e._v("好评")]),a("el-radio",{attrs:{label:"middle"}},[e._v("中评")]),a("el-radio",{attrs:{label:"bad"}},[e._v("差评")])],1)],1),a("el-form-item",{attrs:{label:"综合评价",prop:"score"}},[a("el-rate",{model:{value:e.evaluationForm.score,callback:function(t){e.$set(e.evaluationForm,"score",t)},expression:"evaluationForm.score"}})],1),a("el-form-item",{attrs:{label:"网络质量",prop:"netword_score"}},[a("el-rate",{model:{value:e.evaluationForm.netword_score,callback:function(t){e.$set(e.evaluationForm,"netword_score",t)},expression:"evaluationForm.netword_score"}})],1),a("el-form-item",{attrs:{label:"硬件年限",prop:"hardware_score"}},[a("el-rate",{model:{value:e.evaluationForm.hardware_score,callback:function(t){e.$set(e.evaluationForm,"hardware_score",t)},expression:"evaluationForm.hardware_score"}})],1),a("el-form-item",{attrs:{label:"评价内容",prop:"content"}},[a("el-input",{attrs:{type:"textarea",rows:"5",maxlength:"100","show-word-limit":""},model:{value:e.evaluationForm.content,callback:function(t){e.$set(e.evaluationForm,"content",t)},expression:"evaluationForm.content"}})],1),a("el-form-item",{attrs:{label:"上传图片"}},[a("el-upload",{ref:"evaluateUpload",attrs:{action:e.uploadAction,name:"image","list-type":"picture","with-credentials":!0,"on-success":e.handleUploadSuccessEvaluate,"on-remove":e.handleUploadRemovEvaluate}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("格式支持PNG、JPG、GIF")])],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEvaluation("evaluateRef")}}},[e._v("确 定")]),a("el-button",{on:{click:function(t){e.evaluationDialogVisible=!1}}},[e._v("取 消")])],1)],1)],1)},v=[],h={name:"RenewOrder",components:{},prop:{},data:function(){return{uploadAction:this.$baseUrl+"/agent/upload",evaluationDialogVisible:!1,showSearchArea:!1,tableLoading:!1,searchTime:[],formData:{page:1,limit:Number(localStorage.getItem("limit"))||50,order:"id",sort:"DESC",type:"order_type",id:void 0,name:void 0,order_status:void 0,order_type:void 0,amount:void 0,supplier:void 0,start_time:void 0,end_time:void 0},total:0,tableData:[],supplier:[],evaluationForm:{supplier_username:void 0,id:void 0,content:void 0,type:void 0,score:void 0,netword_score:void 0,hardware_score:void 0,img:[]},evaluateReles:{content:[{required:!0,message:"请输入评价内容",trigger:"blur"}],type:[{required:!0,message:"请选择评价",trigger:"change"}],score:[{required:!0,message:"请选择综合评价",trigger:"change"}],netword_score:[{required:!0,message:"请选择网络质量评价",trigger:"change"}],hardware_score:[{required:!0,message:"请选择硬件年限评价",trigger:"change"}]}}},created:function(){this.getData()},mounted:function(){},computed:{},methods:{getData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableLoading=!0,t.next=3,Object(s["q"])(e.formData);case 3:if(a=t.sent,r=a.data,200===r.status){t.next=7;break}return t.abrupt("return",e.$message.error(r.msg));case 7:e.tableData=r.data.rows,e.total=r.data.count,e.tableLoading=!1;case 10:case"end":return t.stop()}}),t)})))()},getRenewSearchData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["r"])();case 2:if(a=t.sent,r=a.data,200===r.status){t.next=6;break}return t.abrupt("return",e.$message.error(r.msg));case 6:e.supplier=r.data.supplier;case 7:case"end":return t.stop()}}),t)})))()},handleCurrentChange:function(e){this.formData.page=e,this.getData()},handleSizeChange:function(e){this.formData.limit=e,this.getData()},searchHandeClick:function(){},handleSearch:function(){for(var e in this.formData)this.formData[e]||(this.formData[e]=void 0);this.getData()},dateSelectChange:function(e){e?(this.formData.start_time=e[0]/1e3,this.formData.end_time=e[1]/1e3):(this.formData.start_time=void 0,this.formData.end_time=void 0)},handleDelete:function(){this.formData.id=void 0,this.formData.name=void 0,this.formData.order_status=void 0,this.formData.order_type=void 0,this.formData.amount=void 0,this.formData.supplier=void 0,this.formData.start_time=void 0,this.formData.end_time=void 0,this.searchTime=[],this.getData()},handleIsEvaluation:function(e){this.evaluationForm.id=e.id,this.evaluationForm.supplier_username=e.supplier_username,this.evaluationDialogVisible=!0},handleUploadSuccessEvaluate:function(e){if(200!==e.status)return this.$message.error(data.msg);this.evaluationForm.img.push(e.savename)},handleUploadRemovEvaluate:function(e){if(200!==e.response.status)return this.$message.error("移除图片有误");this.$delete(this.evaluationForm.img,this.evaluationForm.img.findIndex((function(t){return t==e.response.savename})))},handleEvaluation:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(a){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=14;break}return delete t.evaluationForm.supplier_username,e.next=4,Object(s["j"])(t.evaluationForm);case 4:if(r=e.sent,n=r.data,200===n.status){e.next=8;break}return e.abrupt("return",t.$message.error(n.msg));case 8:t.$message.success(n.msg),t.getData(),t.$refs.evaluateUpload.clearFiles(),t.evaluationDialogVisible=!1,e.next=15;break;case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},handleEvaluateDialogVisibleClosed:function(e){this.evaluationForm.id=void 0,this.evaluationForm.supplier_username=void 0,this.evaluationForm.content=void 0,this.evaluationForm.type=void 0,this.evaluationForm.score=void 0,this.evaluationForm.netword_score=void 0,this.evaluationForm.hardware_score=void 0,this.evaluationForm.img=[],this.$refs.evaluateUpload.clearFiles(),this.$refs[e].resetFields()}}},g=h,b=(a("996a"),Object(d["a"])(g,f,v,!1,null,"06b441b3",null)),_=b.exports,w={name:"Orede",components:{OrderDetail:p,RenewOrder:_},data:function(){return{activeName:"first"}},mounted:function(){},methods:{}},y=w,D=Object(d["a"])(y,r,n,!1,null,"6ba261e4",null);t["default"]=D.exports},"841c":function(e,t,a){"use strict";var r=a("d784"),n=a("825a"),o=a("1d80"),i=a("129f"),l=a("14c3");r("search",1,(function(e,t,a){return[function(t){var a=o(this),r=void 0==t?void 0:t[e];return void 0!==r?r.call(t,a):new RegExp(t)[e](String(a))},function(e){var r=a(t,e,this);if(r.done)return r.value;var o=n(e),s=String(this),u=o.lastIndex;i(u,0)||(o.lastIndex=0);var c=l(o,s);return i(o.lastIndex,u)||(o.lastIndex=u),null===c?-1:c.index}]}))},"98b75":function(e,t,a){},"996a":function(e,t,a){"use strict";var r=a("98b75"),n=a.n(r);n.a},bf7b:function(e,t,a){"use strict";var r=a("2a86"),n=a.n(r);n.a},c740:function(e,t,a){"use strict";var r=a("23e7"),n=a("b727").findIndex,o=a("44d2"),i=a("ae40"),l="findIndex",s=!0,u=i(l);l in[]&&Array(1)[l]((function(){s=!1})),r({target:"Array",proto:!0,forced:s||!u},{findIndex:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),o(l)},db75:function(e,t,a){"use strict";a.d(t,"e",(function(){return n})),a.d(t,"f",(function(){return o})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return l})),a.d(t,"z",(function(){return s})),a.d(t,"l",(function(){return u})),a.d(t,"o",(function(){return c})),a.d(t,"b",(function(){return d})),a.d(t,"x",(function(){return m})),a.d(t,"y",(function(){return p})),a.d(t,"h",(function(){return f})),a.d(t,"i",(function(){return v})),a.d(t,"k",(function(){return h})),a.d(t,"w",(function(){return g})),a.d(t,"s",(function(){return b})),a.d(t,"g",(function(){return _})),a.d(t,"t",(function(){return w})),a.d(t,"n",(function(){return y})),a.d(t,"u",(function(){return D})),a.d(t,"v",(function(){return k})),a.d(t,"p",(function(){return x})),a.d(t,"a",(function(){return F})),a.d(t,"q",(function(){return $})),a.d(t,"r",(function(){return S})),a.d(t,"m",(function(){return O})),a.d(t,"j",(function(){return R}));var r=a("a27e");function n(e){return Object(r["a"])({url:"agent/order",params:e})}function o(e){return Object(r["a"])({url:"agent/products",params:e})}function i(e){return Object(r["a"])({url:"agent/inspectionlists",params:e})}function l(e){return Object(r["a"])({url:"agent/inspectionip",params:e})}function s(e){return Object(r["a"])({url:"agent/resourceinspection",method:"post",data:e})}function u(e){return Object(r["a"])({url:"agent/inspectiondetail",params:e})}function c(e){return Object(r["a"])({url:"agent/refund",method:"post",data:e})}function d(e){return Object(r["a"])({url:"agent/aftersale",method:"post",data:e})}function m(e){return Object(r["a"])({url:"agent/unaftersale",method:"post",data:e})}function p(e){return Object(r["a"])({url:"agent/host",params:e})}function f(){return Object(r["a"])({url:"agent/baseinfo",method:"get"})}function v(e){return Object(r["a"])({url:"agent/consumption",method:"get",params:e})}function h(e){return Object(r["a"])({url:"agent/income",method:"get",params:e})}function g(e){return Object(r["a"])({url:"agent/tickets",method:"get",params:e})}function b(){return Object(r["a"])({url:"agent/resourceinfo",method:"get"})}function _(e){return Object(r["a"])({url:"agent/resourceinfo",method:"post",data:e})}function w(e){return Object(r["a"])({url:"agent/resourceticketopen",method:"post",data:e})}function y(){return Object(r["a"])({url:"agent/linktoresource",method:"post"})}function D(e){return Object(r["a"])({url:"agent/runmaplists",method:"get",params:e})}function k(){return Object(r["a"])({url:"agent/ordersearchpage"})}function x(e){return Object(r["a"])({url:"agent/refundDetail?id=".concat(e)})}function F(e){return Object(r["a"])({url:"agent/afterSaleDetail?id=".concat(e)})}function $(e){return Object(r["a"])({url:"agent/renew",params:e})}function S(){return Object(r["a"])({url:"agent/renewsearchpage"})}function O(e){return Object(r["a"])({url:"agent/agentLogs",params:e})}function R(e){return Object(r["a"])({url:"agent/evaluation",method:"POST",data:e})}}}]);